var mod;mod=angular.module("infinite-scroll",[]),mod.value("THROTTLE_MILLISECONDS",null),mod.directive("infiniteScroll",["$rootScope","$window","$interval","THROTTLE_MILLISECONDS",function(e,t,n,r){return{scope:{infiniteScroll:"&",infiniteScrollContainer:"=",infiniteScrollDistance:"=",infiniteScrollDisabled:"=",infiniteScrollUseDocumentBottom:"=",infiniteScrollListenForEvent:"@"},link:function(a,i,l){var s,o,c,u,g,f,d,m,h,p,v,S,w,y,$,k,P,x;return x=angular.element(t),w=null,y=null,o=null,c=null,p=!0,P=!1,k=null,h=function(e){return e=e[0]||e,isNaN(e.offsetHeight)?e.document.documentElement.clientHeight:e.offsetHeight},v=function(e){return e[0].getBoundingClientRect&&!e.css("none")?e[0].getBoundingClientRect().top+S(e):void 0},S=function(e){return e=e[0]||e,isNaN(window.pageYOffset)?e.document.documentElement.scrollTop:e.ownerDocument.defaultView.pageYOffset},m=function(){var t,n,r,l,s;return c===x?(t=h(c)+S(c[0].document.documentElement),r=v(i)+h(i)):(t=h(c),n=0,void 0!==v(c)&&(n=v(c)),r=v(i)-n+h(i)),P&&(r=h((i[0].ownerDocument||i[0].document).documentElement)),l=r-t,s=l<=h(c)*w+1,s?(o=!0,y?a.$$phase||e.$$phase?a.infiniteScroll():a.$apply(a.infiniteScroll):void 0):o=!1},$=function(e,t){var r,a,i;return i=null,a=0,r=function(){var t;return a=(new Date).getTime(),n.cancel(i),i=null,e.call(),t=null},function(){var l,s;return l=(new Date).getTime(),s=t-(l-a),0>=s?(clearTimeout(i),n.cancel(i),i=null,a=l,e.call()):i?void 0:i=n(r,s,1)}},null!=r&&(m=$(m,r)),a.$on("$destroy",function(){return c.unbind("scroll",m),null!=k?(k(),k=null):void 0}),f=function(e){return w=parseFloat(e)||0},a.$watch("infiniteScrollDistance",f),f(a.infiniteScrollDistance),g=function(e){return y=!e,y&&o?(o=!1,m()):void 0},a.$watch("infiniteScrollDisabled",g),g(a.infiniteScrollDisabled),d=function(e){return P=e},a.$watch("infiniteScrollUseDocumentBottom",d),d(a.infiniteScrollUseDocumentBottom),s=function(e){return null!=c&&c.unbind("scroll",m),c=e,null!=e?c.bind("scroll",m):void 0},s(x),a.infiniteScrollListenForEvent&&(k=e.$on(a.infiniteScrollListenForEvent,m)),u=function(e){if(null!=e&&0!==e.length){if(e instanceof HTMLElement?e=angular.element(e):"function"==typeof e.append?e=angular.element(e[e.length-1]):"string"==typeof e&&(e=angular.element(document.querySelector(e))),null!=e)return s(e);throw new Exception("invalid infinite-scroll-container attribute.")}},a.$watch("infiniteScrollContainer",u),u(a.infiniteScrollContainer||[]),null!=l.infiniteScrollParent&&s(angular.element(i.parent())),null!=l.infiniteScrollImmediateCheck&&(p=a.$eval(l.infiniteScrollImmediateCheck)),n(function(){return p?m():void 0},0,1)}}}]),angular.module("gettext",[]),angular.module("gettext").constant("gettext",function(e){return e}),angular.module("gettext").factory("gettextCatalog",["gettextPlurals","gettextFallbackLanguage","$http","$cacheFactory","$interpolate","$rootScope",function(e,t,n,r,a,i){function l(){i.$broadcast("gettextLanguageChanged")}var s,o="$$noContext",c='<span id="test" title="test" class="tested">test</span>',u=angular.element("<span>"+c+"</span>").html()!==c,g=function(e){return s.debug&&s.currentLanguage!==s.baseLanguage?s.debugPrefix+e:e},f=function(e){return s.showTranslatedMarkers?s.translatedMarkerPrefix+e+s.translatedMarkerSuffix:e};return s={debug:!1,debugPrefix:"[MISSING]: ",showTranslatedMarkers:!1,translatedMarkerPrefix:"[",translatedMarkerSuffix:"]",strings:{},baseLanguage:"en",currentLanguage:"en",cache:r("strings"),setCurrentLanguage:function(e){this.currentLanguage=e,l()},getCurrentLanguage:function(){return this.currentLanguage},setStrings:function(e,t){this.strings[e]||(this.strings[e]={});for(var n in t){var r=t[n];if(u&&(n=angular.element("<span>"+n+"</span>").html()),angular.isString(r)||angular.isArray(r)){var a={};a[o]=r,r=a}for(var i in r){var s=r[i];r[i]=angular.isArray(s)?s:[s]}this.strings[e][n]=r}l()},getStringFormFor:function(t,n,r,a){if(!t)return null;var i=this.strings[t]||{},l=i[n]||{},s=l[a||o]||[];return s[e(t,r)]},getString:function(e,n,r){var i=t(this.currentLanguage);return e=this.getStringFormFor(this.currentLanguage,e,1,r)||this.getStringFormFor(i,e,1,r)||g(e),e=n?a(e)(n):e,f(e)},getPlural:function(e,n,r,i,l){var s=t(this.currentLanguage);return n=this.getStringFormFor(this.currentLanguage,n,e,l)||this.getStringFormFor(s,n,e,l)||g(1===e?n:r),i&&(i.$count=e,n=a(n)(i)),f(n)},loadRemote:function(e){return n({method:"GET",url:e,cache:s.cache}).then(function(e){var t=e.data;for(var n in t)s.setStrings(n,t[n]);return e})}}}]),angular.module("gettext").directive("translate",["gettextCatalog","$parse","$animate","$compile","$window",function(e,t,n,r,a){function i(e,t,n){if(!e)throw new Error("You should add a "+t+" attribute whenever you add a "+n+" attribute.")}var l=function(){return String.prototype.trim?function(e){return"string"==typeof e?e.trim():e}:function(e){return"string"==typeof e?e.replace(/^\s*/,"").replace(/\s*$/,""):e}}(),s=parseInt((/msie (\d+)/.exec(angular.lowercase(a.navigator.userAgent))||[])[1],10);return{restrict:"AE",terminal:!0,compile:function(a,o){i(!o.translatePlural||o.translateN,"translate-n","translate-plural"),i(!o.translateN||o.translatePlural,"translate-plural","translate-n");var c=l(a.html()),u=o.translatePlural,g=o.translateContext;return 8>=s&&"<!--IE fix-->"===c.slice(-13)&&(c=c.slice(0,-13)),{post:function(a,i,s){function o(){var t;u?(a=d||(d=a.$new()),a.$count=f(a),t=e.getPlural(a.$count,c,u,null,g)):t=e.getString(c,null,g);var s=i.contents();if(0!==s.length){if(t===l(s.html()))return void(m&&r(s)(a));var o=angular.element("<span>"+t+"</span>");r(o.contents())(a);var h=o.contents();n.enter(h,i),n.leave(s)}}var f=t(s.translateN),d=null,m=!0;s.translateN&&a.$watch(s.translateN,o),a.$on("gettextLanguageChanged",o),o(),m=!1}}}}}]),angular.module("gettext").factory("gettextFallbackLanguage",function(){var e={},t=/([^_]+)_[^_]+$/;return function(n){if(e[n])return e[n];var r=t.exec(n);return r?(e[n]=r[1],r[1]):null}}),angular.module("gettext").filter("translate",["gettextCatalog",function(e){function t(t,n){return e.getString(t,null,n)}return t.$stateful=!0,t}]),angular.module("gettext").factory("gettextPlurals",function(){return function(e,t){switch(e){case"ay":case"bo":case"cgg":case"dz":case"fa":case"id":case"ja":case"jbo":case"ka":case"kk":case"km":case"ko":case"ky":case"lo":case"ms":case"my":case"sah":case"su":case"th":case"tt":case"ug":case"vi":case"wo":case"zh":return 0;case"is":return t%10!=1||t%100==11?1:0;case"jv":return 0!=t?1:0;case"mk":return 1==t||t%10==1?0:1;case"ach":case"ak":case"am":case"arn":case"br":case"fil":case"fr":case"gun":case"ln":case"mfe":case"mg":case"mi":case"oc":case"pt_BR":case"tg":case"ti":case"tr":case"uz":case"wa":case"zh":return t>1?1:0;case"lv":return t%10==1&&t%100!=11?0:0!=t?1:2;case"lt":return t%10==1&&t%100!=11?0:t%10>=2&&(10>t%100||t%100>=20)?1:2;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return t%10==1&&t%100!=11?0:t%10>=2&&4>=t%10&&(10>t%100||t%100>=20)?1:2;case"mnk":return 0==t?0:1==t?1:2;case"ro":return 1==t?0:0==t||t%100>0&&20>t%100?1:2;case"pl":return 1==t?0:t%10>=2&&4>=t%10&&(10>t%100||t%100>=20)?1:2;case"cs":case"sk":return 1==t?0:t>=2&&4>=t?1:2;case"sl":return t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0;case"mt":return 1==t?0:0==t||t%100>1&&11>t%100?1:t%100>10&&20>t%100?2:3;case"gd":return 1==t||11==t?0:2==t||12==t?1:t>2&&20>t?2:3;case"cy":return 1==t?0:2==t?1:8!=t&&11!=t?2:3;case"kw":return 1==t?0:2==t?1:3==t?2:3;case"ga":return 1==t?0:2==t?1:7>t?2:11>t?3:4;case"ar":return 0==t?0:1==t?1:2==t?2:t%100>=3&&10>=t%100?3:t%100>=11?4:5;default:return 1!=t?1:0}}}),function(e){"use strict";function t(t,n,r,a,i,l,s,o){function c(){return S.pagesManager.retrieveUpdate(!p).then(function(e){S.newPosts=e._items})}function u(){return S.stickyPagesManager.retrieveUpdate(!p).then(function(e){S.newStickyPosts=e._items})}function g(){r.get({},function(t){e.extend(S.blog,t)})}var f=a.settings.postsPerPage,d=100,m=a.settings.permalinkDelimiter||"?",h=a.settings.postOrder,p=a.settings.loadNewPostsManually,v=1e4,S=this,w=new n(f,h,!1),y=new s(w,m),$=new n(d,h,!0),k=new s($,m);e.extend(S,{templateDir:a.assets_root,blog:o(a.blog),loading:!0,finished:!1,highlightsOnly:!1,settings:a.settings,newPosts:[],newStickyPosts:[],orderBy:function(e){S.loading=!0,S.finished=!1,S.pagesManager.changeOrder(e).then(function(e){S.loading=!1,S.finished=e._meta.total<=e._meta.max_results})},fetchNewPage:function(){return S.loading=!0,S.stickyPagesManager.fetchNewPage(),S.pagesManager.fetchNewPage().then(function(e){S.loading=!1,S.finished=e._meta.total<=e._meta.max_results})},permalinkScroll:function(){S.loading=!0,S.permalink.loadPost().then(function(e){i(e),S.loading=!1},function(){S.loading=!1})},isAllowedToLoadMore:function(){return!S.loading&&!S.finished},applyUpdates:function(){w.applyUpdates(S.newPosts),S.newPosts=[],$.applyUpdates(S.newStickyPosts),S.newStickyPosts=[]},toggleHighlighsOnly:function(){S.highlightsOnly=!S.highlightsOnly,w.changeHighlight(S.highlightsOnly),$.changeHighlight(S.highlightsOnly),S.highlightsOnly&&($.hideSticky=!1)},pagesManager:w,permalink:y,stickyPagesManager:$,stickyPermalink:k}),S.fetchNewPage().then(function(){function e(e){"loadMore"===e.data&&n()}S.permalinkScroll(),t(c,v),t(u,v),t(g,3*v);var n=_.debounce(S.fetchNewPage,1e3);window.addEventListener("message",e,!1)})}t.$inject=["$interval","PagesManager","blogs","config","$anchorScroll","$timeout","Permalink","transformBlog"],e.module("theme",["liveblog-embed","ngAnimate","infinite-scroll","gettext"]).run(["gettextCatalog","config",function(e,t){e.setCurrentLanguage(t.settings.language)}]).controller("TimelineCtrl",t).directive("lbItem",["asset",function(e){return{restrict:"A",templateUrl:e.templateUrl("views/item.html")}}]).directive("lbAuthor",["asset",function(e){return{restrict:"A",scope:{item:"=",timeline:"="},templateUrl:e.templateUrl("views/author.html")}}]).directive("lbPosts",["asset",function(e){return{restrict:"E",scope:{posts:"=",timeline:"="},templateUrl:e.templateUrl("views/posts.html")}}]),e.module("infinite-scroll").value("THROTTLE_MILLISECONDS",1e3)}(angular);